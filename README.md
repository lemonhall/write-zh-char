# æ±‰å­—æçº¢ç»ƒä¹ åº”ç”¨

è¿™æ˜¯ä¸€ä¸ªäº¤äº’å¼æ±‰å­—æçº¢ç»ƒä¹ åº”ç”¨ï¼Œå¸®åŠ©ç”¨æˆ·å­¦ä¹ æ±‰å­—ä¹¦å†™ã€‚åº”ç”¨æä¾›é™æ€æçº¢ã€åŠ¨æ€æçº¢å’Œè‡ªä¸»ç»ƒä¹ ä¸‰ç§æ¨¡å¼ï¼Œæ”¯æŒPCå’Œæ‰‹æœºè®¾å¤‡ï¼Œå¹¶æä¾›å³æ—¶åé¦ˆä¸åŠ¨ç”»æ•ˆæœã€‚

## ğŸ¯ ä¸»è¦åŠŸèƒ½

### 1. é™æ€æçº¢
- å±•ç¤ºæ±‰å­—è½®å»“ä¾›ç”¨æˆ·ææ‘¹
- æ”¯æŒå¤šå­—ç»ƒä¹ 
- æ ¹æ®è®¾å¤‡è‡ªåŠ¨è°ƒæ•´æ¨ª/ç«–æ’å¸ƒå±€

### 2. åŠ¨æ€æçº¢
- åŠ¨ç”»å±•ç¤ºæ±‰å­—ç¬”ç”»ä¹¦å†™è¿‡ç¨‹
- é€šè¿‡åŠ¨ç”»æ¸…æ™°å±•ç¤ºç¬”ç”»é¡ºåºå’Œæ–¹å‘
- å®Œæˆåæ˜¾ç¤ºçƒŸèŠ±ç‰¹æ•ˆ

### 3. è‡ªä¸»ç»ƒä¹ 
- ç”¨æˆ·ä¸»åŠ¨ä¹¦å†™æ±‰å­—
- ç¬”ç”»æ­£ç¡®æ€§å®æ—¶åé¦ˆ
- å®Œæˆåæä¾›æˆåŠŸæç¤ºå’Œç‰¹æ•ˆ

## ğŸ“± è®¾å¤‡å…¼å®¹

- **PCç«¯**ï¼šæ¨ªæ’å¸ƒå±€ï¼Œé€‚åˆå®½å±æ˜¾ç¤º
- **æ‰‹æœºç«¯**ï¼šç«–æ’å¸ƒå±€ï¼Œä¼˜åŒ–è§¦æ‘¸æ“ä½œ

## ğŸ› ï¸ æŠ€æœ¯å®ç°

- ä½¿ç”¨**cnchar**åº“å¤„ç†æ±‰å­—æ•°æ®å’Œä¹¦å†™åŠŸèƒ½
- çº¯å‰ç«¯JavaScriptå®ç°ï¼Œæ— åç«¯ä¾èµ–
- æœ¬åœ°å­˜å‚¨æ±‰å­—ç¬”ç”»æ•°æ®ï¼Œé¿å…ç½‘ç»œè¯·æ±‚
- æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºæ‰©å±•æ–°åŠŸèƒ½
- ä½¿ç”¨**Tauri**æ¡†æ¶æ‰“åŒ…ä¸ºæ¡Œé¢åº”ç”¨ï¼Œæ”¯æŒWindowsã€macOSå’ŒLinux

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
write-zh-char/
â”œâ”€â”€ js/                  # JavaScriptæ¨¡å—
â”‚   â”œâ”€â”€ config.js        # åŸºç¡€é…ç½®å’Œé€šç”¨å‡½æ•°
â”‚   â”œâ”€â”€ core.js          # æ ¸å¿ƒç»˜å›¾åŠŸèƒ½
â”‚   â”œâ”€â”€ effects.js       # ç‰¹æ•ˆå’ŒéŸ³æ•ˆ
â”‚   â”œâ”€â”€ static-draw.js   # é™æ€æçº¢åŠŸèƒ½
â”‚   â”œâ”€â”€ animate-draw.js  # åŠ¨æ€æçº¢åŠŸèƒ½
â”‚   â”œâ”€â”€ test-draw.js     # è‡ªä¸»ç»ƒä¹ åŠŸèƒ½
â”‚   â””â”€â”€ main.js          # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ css/                 # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ styles.css       # ä¸»æ ·å¼è¡¨
â”œâ”€â”€ data/                # æœ¬åœ°æ•°æ®
â”‚   â””â”€â”€ dict/            # æ±‰å­—ç¬”ç”»æ•°æ®JSONæ–‡ä»¶
â”œâ”€â”€ sounds/              # éŸ³æ•ˆæ–‡ä»¶
â”œâ”€â”€ dist/                # æ‰“åŒ…è¾“å‡ºç›®å½•ï¼Œç”¨äºTauriæ„å»º
â”œâ”€â”€ src-tauri/           # Tauriç›¸å…³æ–‡ä»¶
â”‚   â”œâ”€â”€ src/             # Rustæºä»£ç 
â”‚   â”œâ”€â”€ Cargo.toml       # Rustä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ tauri.conf.json  # Taurié…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ icons/           # åº”ç”¨å›¾æ ‡
â”œâ”€â”€ cnchar.all.min.js    # cncharæ ¸å¿ƒåº“
â”œâ”€â”€ draw-chinese-congrats.html  # ä¸»é¡µé¢
â”œâ”€â”€ package.json         # é¡¹ç›®ä¾èµ–é…ç½®
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å®‰è£…ä¸ä½¿ç”¨

### å‰ææ¡ä»¶
- Node.js (æ¨èv14æˆ–æ›´é«˜ç‰ˆæœ¬)
- npmæˆ–yarnåŒ…ç®¡ç†å™¨
- ç°ä»£æµè§ˆå™¨ (Chrome, Firefox, Safari, Edgeç­‰)

### Webç‰ˆæœ¬å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**
   ```bash
   git clone <ä»“åº“åœ°å€>
   cd write-zh-char
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **å¤åˆ¶æ±‰å­—æ•°æ®æ–‡ä»¶**
   ```bash
   # åˆ›å»ºæ•°æ®ç›®å½•
   mkdir -p data/dict

   # å¤åˆ¶æ±‰å­—æ•°æ®æ–‡ä»¶
   cp -r node_modules/cnchar-data/draw/*.json data/dict/
   ```
   > æ³¨æ„ï¼šWindowsç³»ç»Ÿä¸‹è¯·ä½¿ç”¨`xcopy`å‘½ä»¤ï¼š`xcopy node_modules\cnchar-data\draw\*.json data\dict\ /Y`

4. **å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨**
   ```bash
   # å¦‚æœå®‰è£…äº†http-server
   http-server
   
   # æˆ–è€…ä½¿ç”¨Pythonå†…ç½®çš„HTTPæœåŠ¡å™¨
   python -m http.server
   ```

5. **è®¿é—®åº”ç”¨**
   - æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:8000/draw-chinese-congrats.html`

### Tauriæ¡Œé¢åº”ç”¨å¼€å‘

#### å‰ææ¡ä»¶
Tauriè¦æ±‚å®‰è£…ç‰¹å®šçš„ç³»ç»Ÿä¾èµ–ï¼Œè¯·æ ¹æ®ä¸åŒæ“ä½œç³»ç»Ÿå®‰è£…å¿…è¦ç»„ä»¶ï¼š

- **Windows**ï¼š
  - [Microsoft Visual C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools/)
  - [WebView2](https://developer.microsoft.com/en-us/microsoft-edge/webview2/)
  - [Rust](https://www.rust-lang.org/tools/install)

- **macOS**ï¼š
  ```bash
  xcode-select --install
  brew install rustup
  rustup-init
  ```

- **Linux**ï¼š
  ```bash
  # Ubuntuç¤ºä¾‹
  sudo apt update
  sudo apt install libwebkit2gtk-4.0-dev build-essential curl libssl-dev libgtk-3-dev libayatana-appindicator3-dev librsvg2-dev
  curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
  ```

#### å¼€å‘æµç¨‹

1. **å‡†å¤‡æ„å»ºç¯å¢ƒ**
   ```bash
   # ç¡®ä¿ä¾èµ–å·²å®‰è£…
   npm install
   
   # å‡†å¤‡distç›®å½•
   mkdir -p dist/data/dict dist/sounds dist/js dist/css
   cp -r data/dict/* dist/data/dict/
   cp -r sounds/* dist/sounds/
   cp -r js/* dist/js/
   cp -r css/* dist/css/
   cp cnchar.all.min.js dist/
   cp draw-chinese-congrats.html dist/index.html
   ```

2. **å¼€å‘æ¨¡å¼è¿è¡ŒTauriåº”ç”¨**
   ```bash
   npm run tauri dev
   ```
   è¿™å°†å¯åŠ¨ä¸€ä¸ªå¼€å‘æ¨¡å¼çš„æ¡Œé¢åº”ç”¨ï¼Œå¯ä»¥å®æ—¶æµ‹è¯•å’Œè°ƒè¯•ã€‚

3. **æ„å»ºæ¡Œé¢åº”ç”¨**
   ```bash
   npm run tauri build
   ```
   ç”Ÿæˆçš„å®‰è£…ç¨‹åºå°†ä½äº `src-tauri/target/release/bundle` ç›®å½•ã€‚

4. **ä»…ä½¿ç”¨å¯æ‰§è¡Œæ–‡ä»¶**
   æ„å»ºå®Œæˆåï¼Œå¯ä»¥åœ¨ `src-tauri/target/release/` ç›®å½•æ‰¾åˆ°ç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼Œæ— éœ€å®‰è£…ã€‚

## ğŸ“‹ Taurié…ç½®è¯´æ˜

Taurié…ç½®æ–‡ä»¶ä½äº `src-tauri/tauri.conf.json`ï¼ŒåŒ…å«ä»¥ä¸‹é‡è¦é…ç½®ï¼š

### åº”ç”¨ä¿¡æ¯é…ç½®
```json
{
  "productName": "HanziWriter",  // åº”ç”¨åç§°
  "version": "1.0.0",           // åº”ç”¨ç‰ˆæœ¬
  "identifier": "com.hanzi.writer"  // åº”ç”¨æ ‡è¯†ç¬¦
}
```

### çª—å£é…ç½®
```json
"windows": [
  {
    "title": "æ±‰å­—æçº¢ç»ƒä¹ ",  // çª—å£æ ‡é¢˜
    "width": 1024,         // çª—å£å®½åº¦
    "height": 768,         // çª—å£é«˜åº¦
    "resizable": true,     // æ˜¯å¦å¯è°ƒæ•´å¤§å°
    "fullscreen": false,   // æ˜¯å¦å…¨å±
    "center": true         // æ˜¯å¦å±…ä¸­æ˜¾ç¤º
  }
]
```

### æ‰“åŒ…é…ç½®
```json
"bundle": {
  "active": true,
  "targets": ["nsis"],  // æ‰“åŒ…æ ¼å¼ï¼Œå¦‚nsis(å®‰è£…åŒ…)ã€msiç­‰
  "icon": [            // åº”ç”¨å›¾æ ‡
    "icons/32x32.png",
    "icons/128x128.png",
    "icons/icon.ico"
  ],
  "resources": [      // éœ€è¦æ‰“åŒ…çš„èµ„æºæ–‡ä»¶
    "../dist/data/**/*.json",
    "../dist/sounds/*"
  ]
}
```

### èµ„æºåŠ è½½æœºåˆ¶

åœ¨Tauriåº”ç”¨ä¸­ï¼Œèµ„æºæ–‡ä»¶çš„åŠ è½½è·¯å¾„ä¸æ™®é€šWebåº”ç”¨ä¸åŒï¼š

```javascript
// åœ¨æµè§ˆå™¨ç¯å¢ƒï¼š
let dataPath = './data/dict/';

// åœ¨Tauriç¯å¢ƒï¼š
if (window.tauriApi && window.tauriApi.isTauri) {
  dataPath = await window.tauriApi.getResourcePath('data/dict/');
}
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

- **ä¿®æ”¹æ ·å¼**ï¼šç¼–è¾‘`css/styles.css`æ–‡ä»¶
- **è°ƒæ•´åŠ¨ç”»é€Ÿåº¦**ï¼šåœ¨`js/animate-draw.js`ä¸­ä¿®æ”¹ç›¸å…³å‚æ•°
- **å¢åŠ æ–°åŠŸèƒ½**ï¼šå¯åœ¨`js/`ç›®å½•ä¸‹åˆ›å»ºæ–°æ¨¡å—ï¼Œå¹¶åœ¨`main.js`ä¸­å¼•å…¥
- **è‡ªå®šä¹‰Taurié…ç½®**ï¼šç¼–è¾‘`src-tauri/tauri.conf.json`æ–‡ä»¶

## ğŸ“˜ æ±‰å­—æ•°æ®è¯´æ˜

åº”ç”¨ä½¿ç”¨`cnchar-data`åŒ…ä¸­çš„æ±‰å­—ç¬”ç”»æ•°æ®ï¼ŒåŒ…å«çº¦9500ä¸ªå¸¸ç”¨æ±‰å­—ï¼Œæ¯ä¸ªæ±‰å­—å¯¹åº”ä¸€ä¸ªJSONæ–‡ä»¶ï¼Œå­˜å‚¨äº`data/dict/`ç›®å½•ã€‚

æ¯ä¸ªJSONæ–‡ä»¶åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š
- æ±‰å­—ç¼–ç 
- ç¬”ç”»æ•°é‡
- æ¯ä¸ªç¬”ç”»çš„åæ ‡ç‚¹
- ç¬”ç”»ç±»å‹ï¼ˆæ¨ªã€ç«–ã€æ’‡ã€æºç­‰ï¼‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼Œæäº¤é—®é¢˜æˆ–å»ºè®®ï¼š

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## ğŸ“ å¼€å‘æ³¨æ„äº‹é¡¹

- PC/æ‰‹æœºä½¿ç”¨ä¸åŒçš„å¸ƒå±€æ–¹å¼ï¼Œé€šè¿‡`isDevicePC()`å‡½æ•°åˆ¤æ–­

## ğŸ“± Android APKæ„å»ºæŒ‡å—

è¦å°†åº”ç”¨æ„å»ºä¸ºAndroid APKï¼Œéœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

### 1. ç¯å¢ƒå‡†å¤‡

æ„å»ºAndroid APKéœ€è¦ä»¥ä¸‹ç¯å¢ƒï¼š

- Android Studio (åŒ…å« Android SDK å’Œ Build-Tools)
- Android NDK (ç¡®ä¿ç‰ˆæœ¬ä¸é¡¹ç›®å…¼å®¹)
- JDK 17
- **é‡è¦**ï¼šé™¤äº†è®¾ç½® `ANDROID_HOME`, `NDK_HOME`, `JAVA_HOME` ç¯å¢ƒå˜é‡å¤–ï¼Œè¯·ç¡®ä¿ä»¥ä¸‹å‘½ä»¤è¡Œå·¥å…·ä¹Ÿä½äºç³»ç»Ÿçš„ `PATH` ç¯å¢ƒå˜é‡ä¸­ï¼Œä»¥ä¾¿äºæ„å»ºå’Œé—®é¢˜æ’æŸ¥ï¼š
  - `keytool`: é€šå¸¸ä½äº `$JAVA_HOME/bin` ç›®å½•ä¸‹ã€‚
  - `apksigner`: é€šå¸¸ä½äº `$ANDROID_HOME/build-tools/<version>` ç›®å½•ä¸‹ã€‚

### 2. è®¾ç½®ç¯å¢ƒå˜é‡

åˆ›å»º`setup-android.bat`ï¼ˆWindowsï¼‰æˆ–`setup-android.sh`ï¼ˆLinux/macOSï¼‰è„šæœ¬æ¥è®¾ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼š

```bat
@echo off
REM è®¾ç½®ç¯å¢ƒå˜é‡
set ANDROID_HOME=E:\Android\SDK
set NDK_HOME=E:\Android\SDK\ndk\29.0.13113456
set JAVA_HOME=E:\development\jdk17

REM è®¾ç½®ä»£ç†ï¼ˆå¯é€‰ï¼Œå¦‚æœéœ€è¦åŠ é€Ÿä¸‹è½½ï¼‰
set HTTP_PROXY=http://127.0.0.1:7897
set HTTPS_PROXY=http://127.0.0.1:7897
set http_proxy=http://127.0.0.1:7897
set https_proxy=http://127.0.0.1:7897
set ALL_PROXY=http://127.0.0.1:7897

echo ANDROID_HOMEè®¾ç½®ä¸º: %ANDROID_HOME%
echo NDK_HOMEè®¾ç½®ä¸º: %NDK_HOME%
echo JAVA_HOMEè®¾ç½®ä¸º: %JAVA_HOME%
echo ä»£ç†è®¾ç½®ä¸º: %HTTP_PROXY%

REM è¿è¡Œtauri android initå‘½ä»¤
call npm run tauri android init

REM å¦‚æœåˆå§‹åŒ–æˆåŠŸï¼Œç»§ç»­æ„å»º
if %ERRORLEVEL% EQU 0 (
  echo åˆå§‹åŒ–æˆåŠŸï¼Œå¼€å§‹æ„å»ºAndroid APK...
  cd src-tauri
  call npm run tauri android build
)
```

### 3. åˆå§‹åŒ–Androidæ”¯æŒ

è¿è¡Œä¸Šé¢åˆ›å»ºçš„è„šæœ¬ï¼Œæˆ–æ‰‹åŠ¨æ‰§è¡Œ `npm run tauri android init`ã€‚æ­¤æ­¥éª¤ä¼šåœ¨ `src-tauri/gen/android/` ç›®å½•ä¸‹ç”Ÿæˆ Gradle é¡¹ç›®ç»“æ„ã€‚

**æ³¨æ„**ï¼šæ­¤æ­¥éª¤åï¼Œç­¾åé…ç½®çš„æ ¸å¿ƒæ–‡ä»¶ä¹‹ä¸€ `src-tauri/gen/android/app/build.gradle.kts` ä¼šè¢«åˆ›å»ºæˆ–ä¿®æ”¹ã€‚

### 4. é…ç½®ç­¾åå¯†é’¥åº“

ä¸ºäº†ç”Ÿæˆå·²ç­¾åçš„ Release APKï¼Œä½ éœ€è¦ï¼š

1.  **ç”Ÿæˆå¯†é’¥åº“æ–‡ä»¶**ï¼šå¦‚æœè¿˜æ²¡æœ‰ï¼Œè¯·ä½¿ç”¨ `keytool` ç”Ÿæˆä¸€ä¸ª `.keystore` æ–‡ä»¶ï¼ˆä¾‹å¦‚ `hanzi-writer.keystore`ï¼‰å¹¶å°†å…¶æ”¾ç½®åœ¨ `src-tauri/` ç›®å½•ä¸‹ã€‚è®°ä½ä½ è®¾ç½®çš„**å¯†é’¥åº“å¯†ç  (store password)** å’Œ**å¯†é’¥åˆ«å (key alias)** ä»¥åŠå¯¹åº”çš„**å¯†é’¥å¯†ç  (key password)**ã€‚
    ```bash
    # ç¤ºä¾‹å‘½ä»¤ (åœ¨ src-tauri ç›®å½•è¿è¡Œ)
    keytool -genkey -v -keystore hanzi-writer.keystore -keyalg RSA -keysize 2048 -validity 10000 -alias hanziwriter
    ```
2.  **åˆ›å»º `keystore.properties` æ–‡ä»¶**ï¼šåœ¨ `src-tauri/gen/android/` ç›®å½•ä¸‹ï¼ˆ**æ³¨æ„**ï¼šä¸æ˜¯ `app` å­ç›®å½•ï¼‰åˆ›å»ºä¸€ä¸ªåä¸º `keystore.properties` çš„æ–‡æœ¬æ–‡ä»¶ã€‚
3.  **ç¼–è¾‘ `keystore.properties`**ï¼šå¡«å…¥ä»¥ä¸‹å†…å®¹ï¼Œå¹¶æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ä¿¡æ¯ï¼š
    ```properties
    keyAlias=ä½ çš„å¯†é’¥åˆ«å # ä¾‹å¦‚ hanziwriter
    keyPassword=ä½ çš„å¯†é’¥å¯†ç  # å¯¹åº”åˆ«åçš„å¯†ç 
    # !!! å…³é”®ï¼šç›¸å¯¹äº src-tauri/gen/android/ ç›®å½•ï¼ŒæŒ‡å‘ src-tauri/ ç›®å½•ä¸‹çš„å¯†é’¥åº“æ–‡ä»¶
    storeFile=../../../hanzi-writer.keystore
    storePassword=ä½ çš„å¯†é’¥åº“å¯†ç  # æ•´ä¸ª keystore æ–‡ä»¶çš„å¯†ç 
    ```
    **åŠ¡å¿…ç¡®ä¿**ï¼š
    - å¯†ç æ­£ç¡®æ— è¯¯ï¼Œä¸”æœ«å°¾æ²¡æœ‰å¤šä½™ç©ºæ ¼ã€‚
    - `storeFile` çš„ç›¸å¯¹è·¯å¾„æ­£ç¡®æŒ‡å‘ä½ çš„ `.keystore` æ–‡ä»¶ã€‚

### 5. æ„å»ºAPK (æ£€æŸ¥ Gradle é…ç½®)

ç°åœ¨å¯ä»¥è¿è¡Œæ„å»ºå‘½ä»¤ï¼š

```bash
# Windows
.\setup-android.bat
```
æˆ–è€…ï¼Œå¦‚æœæ‚¨é…ç½®å¥½äº†ç­¾åï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼š
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
npm run tauri android build
```

**é¦–æ¬¡æ„å»ºåæ£€æŸ¥**ï¼šTauri åº•å±‚ä½¿ç”¨ Gradle æ„å»ºã€‚æ„å»ºè¿‡ç¨‹ä¾èµ– `src-tauri/gen/android/app/build.gradle.kts` æ–‡ä»¶ã€‚è¯·æ‰“å¼€æ­¤æ–‡ä»¶ï¼Œæ£€æŸ¥ä»¥ä¸‹å…³é”®é…ç½®æ˜¯å¦å­˜åœ¨ä¸”æ­£ç¡®ï¼š

```kotlin
// src-tauri/gen/android/app/build.gradle.kts

import java.io.FileInputStream // ç¡®ä¿è¿™ä¸ª import å­˜åœ¨
// ... å…¶ä»– imports ...

android {
    // ...
    signingConfigs {
        create("release") {
            // æ£€æŸ¥è¿™é‡Œçš„è·¯å¾„æ˜¯å¦æ­£ç¡®æŒ‡å‘ src-tauri/gen/android/keystore.properties
            val keystorePropertiesFile = rootProject.file("keystore.properties")
            // ... ç¡®ä¿åŠ è½½ keystore.properties çš„é€»è¾‘å­˜åœ¨ ...
        }
    }

    buildTypes {
        getByName("release") {
            // !!! å…³é”®ï¼šç¡®ä¿è¿™ä¸€è¡Œå­˜åœ¨ä¸”æ²¡æœ‰è¢«æ³¨é‡Š !!!
            signingConfig = signingConfigs.getByName("release")
            // ... å…¶ä»– release é…ç½® ...
        }
        // ... debug é…ç½® ...
    }
    // ...
}
```
å¦‚æœç¼ºå°‘ `signingConfigs` å—æˆ– `release` ä¸­çš„ `signingConfig = ...` è¡Œï¼Œè¯·å‚è€ƒä¸Šé¢ç¤ºä¾‹æ‰‹åŠ¨æ·»åŠ æˆ–å–æ¶ˆæ³¨é‡Šã€‚

### 6. å¸¸è§é—®é¢˜ä¸æ’æŸ¥

#### ç¯å¢ƒå˜é‡é—®é¢˜

*   **`keytool`/`apksigner` æ‰¾ä¸åˆ°**ï¼šç¡®è®¤ JDK `bin` ç›®å½•å’Œ Android SDK `build-tools` ç›®å½•å·²æ·»åŠ åˆ°ç³»ç»Ÿ `PATH`ã€‚
*   **SDK/NDK/JDK è·¯å¾„é”™è¯¯**ï¼šæ£€æŸ¥ `ANDROID_HOME`, `NDK_HOME`, `JAVA_HOME` ç¯å¢ƒå˜é‡æ˜¯å¦æŒ‡å‘æ­£ç¡®çš„å®‰è£…ä½ç½®ã€‚

#### ä¸‹è½½é€Ÿåº¦æ…¢

*   **ä¸‹è½½ Gradle ä¾èµ–æˆ– Rust å·¥å…·é“¾æ…¢**ï¼š
    *   å°è¯•è®¾ç½® `HTTP_PROXY` å’Œ `HTTPS_PROXY` ç¯å¢ƒå˜é‡ã€‚
    *   é…ç½® Cargo ä½¿ç”¨å›½å†…é•œåƒæº (ç¼–è¾‘ `~/.cargo/config` æˆ– `%USERPROFILE%\.cargo\config`)ã€‚

#### æ„å»ºå¤±è´¥

*   **ç”Ÿæˆ unsigned APK**ï¼š
    *   æ£€æŸ¥ `src-tauri/gen/android/app/build.gradle.kts` æ–‡ä»¶ï¼Œç¡®è®¤ `signingConfigs` å—å­˜åœ¨ï¼Œå¹¶ä¸” `buildTypes.release` ä¸­æœ‰ `signingConfig = signingConfigs.getByName("release")`ã€‚
    *   ç¡®è®¤ `src-tauri/gen/android/keystore.properties` æ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹æ­£ç¡®ã€‚
*   **`keystore.properties not found` é”™è¯¯**ï¼š
    *   ç¡®è®¤æ–‡ä»¶ç¡®å®åœ¨ `src-tauri/gen/android/` ç›®å½•ä¸‹ã€‚
    *   æ£€æŸ¥ `build.gradle.kts` ä¸­ `rootProject.file(...)` çš„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆåº”ä¸º `"keystore.properties"`ï¼‰ã€‚
*   **`Keystore file '...' not found` é”™è¯¯**ï¼š
    *   æ£€æŸ¥ `keystore.properties` æ–‡ä»¶ä¸­çš„ `storeFile` ç›¸å¯¹è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆé€šå¸¸æ˜¯ `../../../hanzi-writer.keystore`ï¼‰ã€‚
    *   ç¡®è®¤ `.keystore` æ–‡ä»¶æœ¬èº«å­˜åœ¨äº `src-tauri/` ç›®å½•ã€‚
*   **`keystore password was incorrect` æˆ– `Failed to read key ...` é”™è¯¯**ï¼š
    *   ä»”ç»†æ£€æŸ¥ `keystore.properties` æ–‡ä»¶ä¸­çš„ `storePassword` å’Œ `keyPassword` æ˜¯å¦ä¸ç”Ÿæˆå¯†é’¥åº“æ—¶è®¾ç½®çš„å®Œå…¨ä¸€è‡´ã€‚
    *   ç¡®ä¿å¯†ç æœ«å°¾æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼ã€‚
*   **å…¶ä»– Gradle é”™è¯¯**ï¼šè¿è¡Œ `npm run tauri android build -- --verbose` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—è¿›è¡Œåˆ†æã€‚

### 7. å®‰è£…å’Œæµ‹è¯•

æ„å»ºæˆåŠŸåï¼Œ**å·²ç­¾å**çš„APKæ–‡ä»¶å°†ä½äºï¼š`src-tauri/gen/android/app/build/outputs/apk/universal/release/app-universal-release.apk`ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ `adb` å‘½ä»¤å®‰è£…ï¼š
```powershell
# ç¡®ä¿ adb åœ¨ PATH ä¸­ï¼Œä¸”è®¾å¤‡å·²è¿æ¥å¹¶æˆæƒ
adb install .\src-tauri\gen\android\app\build\outputs\apk\universal\release\app-universal-release.apk
```

æ‚¨å¯ä»¥ï¼š
- ä½¿ç”¨USBè¿æ¥Androidè®¾å¤‡å¹¶ç›´æ¥å®‰è£…APK

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- ç”µå­é‚®ä»¶ï¼š[your-email@example.com]
- GitHub Issuesï¼š[é¡¹ç›®Issuesé¡µé¢]
